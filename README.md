# Пример использования

Класс контроллера с экшеном:

    class DemoController
    {
        static public function nodeAction2($_mode, $node_id = '(\d+)'){
            if ($_mode == \OLOG\Router::GET_URL) return '/node/' . $node_id;
            if ($_mode == \OLOG\Router::GET_METHOD) return __METHOD__;
    
            NodePageTemplate::render($node_id);
        }
    }

Экшен может или возвратить адрес страницы для материала, или вывести страницу материала.
Экшен принимает для параметра:

- $_mode: что надо сделать: вернуть урл страницы или вывести страницу 
- $node_id: идентификатор материала, который надо вывести

Зачем получение адреса и генерация страницы соединены в одной функции? См. "Удобная навигация по коду".

Роутинг для этого экшена в точке входа (в index.php):
  
    Router::match3(\PHPRouterDemo\DemoController::nodeAction2(Router::GET_METHOD));
    
Здесь мы получаем callable экшена и отдаем его роутеру (почему не указать callable явно, избежав лишнего вызова экшена? См. ниже).

Роутер вызывает экшен с параметром GET_URL и получает маску адресов, которые может обработать этот экшен (регексп). Если экшен принимает дополнительные параметры - он должен подставить в маску адреса шаблон для этих параметров, в примере выше это сделано через значение параметра по умолчанию.
Если запрошенный адрес соответствует этой маске - роутер вызывает экшен снова, на этот раз с параметром EXECUTE_ACTION. После этого роутер завершает обработку запроса.
 
Экшен может дополнительно проверить запрошенный адрес и если он все-таки не может обработать такой адрес - экшен может вернуть CONTINUE_ROUTING. Тогда роутер не будет останавливать обработку запроса и продолжит проверять другие экшены. 

# Какие задачи решает роутер

## Генерация адресов для экшенов
Для того, чтобы сгенерировать адрес для экшена, нужно вызвать соответствующий экшен с параметром GET_URL.

Если экшен поддерживает получение параметров - он может подставить их в адрес, для этого параметры надо просто передать экшену как обычно.

Сам роутер получает адреса экшенов для роутинга по этой же технологии.

## Удобная навигация по коду
Для генерации адреса и для вывода результата используется один и тот же метод. Поэтому, если в коде где-то генерируется адрес для экшена - можно перейти в сам экшен, просто кликнув в IDE на вызов метода.

Можно найти все точки в коде, где используется адрес экшена, просто найдя вызовы метода.

## В коде не должно быть имен классов, имен функций и урлов в виде строковых констант
Адреса для экшенов хранятся в коде только в одном месте: в самом экшене. Во всех остальных местах для получения адреса можно использовать вызов экшена с параметром GET_URL, таким образом адреса можно менять централизованно.

Имя метода экшена для роутинга передается роутеру не как строка, а через вызов самого метода с параметром GET_METHOD. Таким образом можно рефакторить методы экшенов, например, переименовывать их, без необходимости находить и менять строки в коде. Также можно находить все использования методов средствами IDE.